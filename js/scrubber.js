export default function Scrubber(e,{el_id:l="#sc",format:n=(e=>e),initial:t=0,direction:u=1,delay:i=null,autoplay:a=!0,loop:r=!0,loopDelay:o=null,alternate:m=!1}={}){e=Array.from(e);const s=(b="<form class='flex-center'>  <button name=b type=button  class='btn btn-outline-dark' style='margin-right: 0.4em; width: 5em;'></button>    <label class='flex-center'>    <input name=i type=range min=0 max="+(e.length-1)+" value="+t+" step=1 style='width: 180px;'>      <output name=o style='margin-left: 0.4em;'></output>    </label>  </form>",(c=document.getElementById(l)).innerHTML=b.trim(),c.firstChild);var b,c;let v=null,f=null,p=null;function d(){s.b.textContent="Pause",null===i?v=requestAnimationFrame(g):p=setInterval(g,i)}function A(){s.b.textContent="Play",null!==v&&(cancelAnimationFrame(v),v=null),null!==f&&(clearTimeout(f),f=null),null!==p&&(clearInterval(p),p=null)}function h(){return null!==v||null!==f||null!==p}function g(){if(s.i.valueAsNumber===(u>0?e.length-1:u<0?0:NaN)){if(!r)return A();if(m&&(u=-u),null!==o)return null!==v&&(cancelAnimationFrame(v),v=null),null!==p&&(clearInterval(p),p=null),void(f=setTimeout(()=>(y(),d()),o))}null===i&&(v=requestAnimationFrame(g)),y()}function y(){s.i.valueAsNumber=(s.i.valueAsNumber+u+e.length)%e.length,s.i.dispatchEvent(new CustomEvent("input",{bubbles:!0}))}return s.i.oninput=(l=>{l&&l.isTrusted&&h()&&A(),s.value=e[s.i.valueAsNumber],s.o.value=n(s.value,s.i.valueAsNumber,e)}),s.b.onclick=(()=>{if(h())return A();u=m&&s.i.valueAsNumber===e.length-1?-1:1,s.i.valueAsNumber=(s.i.valueAsNumber+u)%e.length,s.i.dispatchEvent(new CustomEvent("input",{bubbles:!0})),d()}),s.i.oninput(),a?d():A(),s};